# 个人记账体系 v2.0（4 模式版）

> 基于 v1.1 五模式体系的**结构性简化版本**，在不损失任何会计语义与分析能力的前提下，将模式数量收敛为 **4 个核心模式**，用于个人记账、AI 自动分类与预算分析系统。

---

## 1. 设计目标

* 降低模式数量，减少使用与 AI 推理复杂度
* 保留现金流、消费发生时间与统计口径的严格区分
* 明确哪些流水**参与分析**，哪些仅用于记录或状态追踪
* 支撑：

  * 自动分类
  * 标签系统（冲动 / 刚需 / 欲望等）
  * 月度预算与偏差分析
  * 大额预付与摊销

---

## 2. 核心设计原则

1. **现金流 ≠ 消费发生**
2. **是否参与统计分析** 是一等公民规则
3. **预付付款是时间错位问题，不能用统计开关解决**
4. 模式数量必须服务于：

   * 用户理解
   * AI 判断
   * 数据一致性

---

## 3. 四大模式总览（v2.0）

| 模式 | 名称    | type    | is_analysis | 核心含义         |
| -- | ----- | ------- | ----------- | ------------ |
| A  | 真实消费  | 支出      | true        | 当期真实发生的消费    |
| B  | 真实收入  | 收入      | true        | 当期真实可支配收入    |
| C  | 非分析流水 | 收入 / 支出 | false       | 仅用于记录，不进入统计  |
| D  | 预付付款  | 资产变动    | false       | 钱已支付，但消费尚未发生 |

---

## 4. 各模式详细说明（口径 + 示例）

---

### 4.1 模式 A：真实消费（Expense）

**定义**：

> 在当前周期内，已经实际发生、应当计入当期消费统计的支出。

**判定标准**：

* 消费已经完成或服务已被使用
* 应计入月度/年度消费分析

**字段规则**：

```json
{
  "type": "支出",
  "is_analysis": true
}
```

**典型场景**：

* 日常餐饮、交通
* 订阅会员的每月扣款
* 分期付款的“每一期”
* 预付项目的每月摊销

**示例**：

| 日期         | 金额   | 描述      | 分类 |
| ---------- | ---- | ------- | -- |
| 2026-03-01 | -200 | 3 月房租摊销 | 住房 |

---

### 4.2 模式 B：真实收入（Income）

**定义**：

> 在当前周期内实际获得、可自由支配的收入。

**字段规则**：

```json
{
  "type": "收入",
  "is_analysis": true
}
```

**典型场景**：

* 工资
* 奖金
* 副业收入

**示例**：

| 日期         | 金额     | 描述 | 分类   |
| ---------- | ------ | -- | ---- |
| 2026-03-05 | +15000 | 工资 | 主业收入 |

---

### 4.3 模式 C：非分析流水（Non-Analytical Flow）

**定义**：

> 具有记录意义，但**不应进入任何消费或收入统计分析**的流水。

**设计说明**：
该模式合并了 v1.1 中的：

* 名义收入
* 记录型支出（如分期总价）

**字段规则**：

```json
{
  "is_analysis": false
}
```

> ⚠️ type 可为「收入」或「支出」，但均不参与分析

**典型场景**：

* 红包、转账代收
* 分期下单时记录的“总价”
* 退款对冲记录

**示例**：

| 日期         | 金额     | 描述        | 说明   |
| ---------- | ------ | --------- | ---- |
| 2026-02-01 | -12000 | 年房租总价（记录） | 不进统计 |

---

### 4.4 模式 D：预付付款（Deferred Expense）

**定义**：

> 现金已经支出，但对应的消费尚未发生，需要在未来周期内逐步确认。

**核心特征**：

* 现金流发生在当前
* 消费发生在未来
* 必须与摊销规则绑定

**字段规则**：

```json
{
  "type": "资产变动",
  "is_analysis": false
}
```

**典型场景**：

* 一次性支付一年房租
* 年费会员
* 大额预付服务

**示例**：

| 日期         | 金额     | 描述         |
| ---------- | ------ | ---------- |
| 2026-02-01 | -12000 | 2026 年房租预付 |

---

## 5. 预付与摊销联动规则（关键）

### 5.1 规则说明

* 每一条「模式 D」必须绑定：

  * 摊销开始时间
  * 摊销周期（月）
  * 摊销金额规则

* 系统在每期自动生成：

  * 对应的「模式 A：真实消费」流水

### 5.2 示例

| 月份  | 自动生成流水     | 模式 |
| --- | ---------- | -- |
| 3 月 | -1000 房租摊销 | A  |
| 4 月 | -1000 房租摊销 | A  |

---

## 6. 标签系统与预算关联（摘要）

* 标签维度：

  * 消费动机：刚需 / 欲望 / 冲动
  * 场景：社交 / 工作 / 家庭

* 仅 **模式 A（真实消费）** 参与：

  * 标签统计
  * 预算占用
  * 偏差分析

---

## 7. AI 自动判定逻辑（简化版）

```
1. 钱是否已实际消费？
   ├─ 是 → 模式 A
   └─ 否 → 继续

2. 是否只是记录、不参与分析？
   ├─ 是 → 模式 C
   └─ 否 → 继续

3. 是否为预付、未来消费？
   └─ 是 → 模式 D
```

---

## 8. 版本说明

* v1.1：5 模式（概念完整，偏复杂）
* **v2.0：4 模式（推荐对外 / AI 使用）**

> 本版本为长期稳定版本，适合用于产品 PRD、数据建模与 AI Prompt 系统。
